
<div id="page-wrapper">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Thêm tài khoản</h1>
                <form class="form-horizontal" action="" method="POST" enctype="application/x-www-form-urlencoded" onsubmit="return checkPw(this);">
                  <div class="row">
                    <div class=" col-lg-12">
                      <div class=" panel panel-default">
                        <div class="panel-heading">
                            Nhập thông tin Cá nhân
                        </div>
                        <div class="panel-body" >
                          <div class="row">
                            <div class="form-group col-md-4" style="margin-left: 5px;">
                                <label>Họ tên *</label>
                                <input required class="form-control" value="<%= data1[0][0].HOTEN%>" name="hoten" type="text" autofocus autocomplete="off">
                            </div>
                            <div class="form-group col-md-4" style="margin-left: 5px;">
                              <label>Giới Tính *</label>
                              <select class="form-control" name="gioitinh" id="gioitinh">
                                <option value="<%= data1[0][0].GIOITINH%>"><%= data1[0][0].GIOITINH%></option>
                                <option value="<%= gt%>"><%= gt%></option>
                              </select>
                            </div>
                            <div class="form-group col-md-4" style="margin-left: 5px;">
                              <label>Ngày sinh *</label>
                              <input required class="form-control" value="<%= ns[0][0].to_char%>"  name="ngaysinh" type="date" autofocus autocomplete="off">
                            </div>
                            <div class="form-group col-md-4" style="margin-left: 5px;">
                              <label>Số CMND *</label>
                              <input required class="form-control" value="<%= data1[0][0].CMND%>" name="cmnd" type="text" autofocus autocomplete="off">
                            </div>
                            <div class="form-group col-md-4" style="margin-left: 5px;">
                              <label>Ngày cấp *</label>
                              <input required class="form-control" value="<%= nc[0][0].to_char%>" name="ngaycap" type="date" autofocus autocomplete="off">
                            </div>
                            <div class="form-group col-md-4" style="margin-left: 5px;">
                              <label>Nơi cấp *</label>
                              <input required class="form-control" value="<%= data1[0][0].NOICAP%>" name="noicap" type="rext" autofocus autocomplete="off">
                            </div>
                            <div class="form-group col-md-4" style="margin-left: 5px;">
                              <label>Số điện thoại *</label>
                              <input required class="form-control" value="<%= data1[0][0].SDT%>" name="sdt" type="text" autofocus autocomplete="off">
                            </div>
                            <div class="form-group col-md-4" style="margin-left: 5px;">
                              <label>E-Mail</label>
                              <input class="form-control" value="<%= data1[0][0].MAIL%>" name="mail" type="email" autofocus autocomplete="off">
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- Close panel -->
                    </div>
                    <div class="col-md-12">
                      <div class="panel panel-default">
                        <div class="panel-heading">
                            Nhập thông tin Cơ quan
                        </div>
                        <div class="panel-body" >
                          <div class="row">
                              <div class="form-group col-md-4" style="margin-left: 5px;">
                                <label>Mã Cơ quan</label>
                                <input id="macoquan" class="form-control" value="<%= data1[0][0].MA_COQUAN%>" name="macoquan" type="text" autofocus autocomplete="off">
                              </div>
                              <div class="form-group col-md-4" style="margin-left: 5px;">
                                <label>Tên Cơ quan *</label>
                                <input required class="form-control" value="<%= data1[0][0].TEN_COQUAN%>" name="tencoquan" type="text" autofocus autocomplete="off">
                              </div>
                              <div class="form-group col-md-4" style="margin-left: 5px;">
                                <label>Bộ phận</label>
                                <input id="bophan" class="form-control" value="<%= data1[0][0].BOPHAN%>" name="bophan" type="text" autofocus autocomplete="off">
                              </div>
                              <div class="form-group col-md-4" style="margin-left: 5px;">
                                <label for="tinhthanh">Tỉnh thành </label>
                                <select class="form-control" name="tinhthanh" id="list1" onchange="getSelect1();">
                                  <option value="<%= data1[0][0].ma_tinh%>"><%= data1[0][0].TEN_TINH%></option>
                                  <% data4.forEach(function(ds){ %>
                                      <option value='<%= ds.id%>'><%= ds.TEN_TINH%></option>
                                  <%})%>
                                </select>
                              </div>
                              <div class="form-group col-md-4" style="margin-left: 5px;">
                                <div id="list2" onchange="getSelect2();">
                                  <label for="quanhuyen">Quận/Huyện </label>
                                  <select class="form-control" name="" id="quanhuyen">
                                    <option value="<%= data1[0][0].ma_quan_huyen%>"><%= data1[0][0].TEN_QUAN_HUYEN%></option>
                                    <% data2.forEach(function(ds){ %>
                                        <option value='<%= ds.id%>'><%= ds.TEN_QUAN_HUYEN%></option>
                                    <%})%>
                                  </select>
                                </div>
                              </div>
                              <div class="form-group col-md-4" style="margin-left: 5px;">
                                <div id="list3">
                                  <label for="phuongxa">Phường/Xã </label>
                                  <select class="form-control" name="phuongxa" id="phuongxa">
                                    <option value="<%= data1[0][0].ma_diachi%>"><%= data1[0][0].TEN_PHUONG_XA%></option>
                                    <% data3.forEach(function(ds){ %>
                                        <option value='<%= ds.id%>'><%= ds.TEN_PHUONG_XA%></option>
                                    <%})%>
                                  </select>
                                </div>
                              </div>
                              <div class="form-group col-md-4" style="margin-left: 5px;">
                                <label>Địa chỉ (Số/Đường/Khóm/Ấp) *</label>
                                <input required class="form-control" value="<%= data1[0][0].DIACHI_SO%>" name="diachi" type="text" autofocus autocomplete="off">
                              </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="panel panel-default">
                        <div class="panel-heading">
                            Nhập thông tin Tài khoản
                        </div>
                        <div class="panel-body" >
                          <div class="row">
                              <div class="form-group col-md-4" style="margin-left: 5px;">
                                  <label>Tên Đăng nhập</label>
                                  <input required class="form-control" value="<%= data1[0][0].username%>" name="us" type="text" autofocus autocomplete="off">
                              </div>
                              <div class="form-group col-md-4" style="margin-left: 5px;">
                                <label>Mật khẩu</label>
                                <input class="form-control" value="<%= data1[0][0].password%>" name="pw" type="password" autofocus autocomplete="off" required>
                              </div>
                              <div class="form-group col-md-4" style="margin-left: 5px;">
                                <label>Xác nhận mật khẩu</label>
                                <input class="form-control" value="<%= data1[0][0].password%>" name="pws" type="password" autofocus autocomplete="off" required>
                              </div>
                              <div class="form-group col-md-4" style="margin-left: 5px;">
                                <label>Trạng thái</label>
                                <select class="form-control" name="tthai">
                                  <option value="<%= data1[0][0].trangthai%>"><%= data1[0][0].TEN_TRANGTHAI%></option>
                                  <% tt.forEach(function(ds){ %>
                                      <option value='<%= ds.id%>'><%= ds.TEN_TRANGTHAI%></option>
                                  <%})%>
                                </select>
                              </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-12">
                      <input style="float: right" type="submit" value="Cập nhật" class="btn btn-primary" />
                      <a style="float: right; margin-right: 4px; margin-bottom: 20px;" href="/admin/taikhoan" class="btn btn-default">Hủy</a>
                    </div>
                  </div>

                </form>
              </div>
                        <!-- /.col-lg-12 -->
            </div>
        </div>
                <!-- /.row -->
    </div>
            <!-- /.container-fluid -->
  </div>
        <!-- /#page-wrapper -->
</div>
    <!-- /#wrapper -->
    <script src="https://nttweb.herokuapp.com/socket.io/socket.io.js"></script>
    <script>
      const socket = io("http://localhost:3000/");
      socket.on("server_sendData_info", function(data){
        if(data == -2){
          alert("Tên tài khoản đã tồn tại!")
        }
      })

      function getSelect1(){
        var temp = "";
        var Sel1 = document.getElementById("list1").value;
        if(Sel1 == ""){
          document.getElementById('list2').style.visibility = 'hidden';
          document.getElementById('list3').style.visibility = 'hidden';
        }else if(Sel1 != null) {
          //Xử lý khi chọn select
          socket.emit("trangchu_sendData_QH",Sel1);
          socket.on("server_sendData_QH", function(data){
            $('#quanhuyen').html("<option value='"+temp+"'>-- Chọn Quận/Huyện --</option>");
            $('#phuongxa').html("<option value='"+temp+"'>-- Chọn Phường/Xã --</option>");
            for(var i = 0; i < data.length; i++){
              $('#quanhuyen').append("<option value='"+data[i].id+"'>"+data[i].TEN_QUAN_HUYEN+"</option>");
            }
          });
          document.getElementById('list2').style.visibility = 'visible';
        }else {
          document.getElementById('list2').style.visibility = 'hidden';
          document.getElementById('list3').style.visibility = 'hidden';
        }
        return false;
      }
    </script>
    <script>
    function getSelect2(){
      var Sel1 = document.getElementById("quanhuyen").value;
      if(Sel1 == ""){
        document.getElementById('list3').style.visibility = 'hidden';
      }else if(Sel1 != null) {
        //Xử lý khi chọn select
        //Khi up ken heruku nho thay doi địc chỉ này
        const socket = io("http://localhost:3000/");
        socket.emit("trangchu_sendData_PX",Sel1);
        socket.on("server_sendData_PX", function(data){
          $('#phuongxa').html('<option value = "">-- Chọn Phường/Xã --</option>');
          for(var i = 0; i < data.length; i++){
            $('#phuongxa').append("<option value='"+data[i].id+"'>"+data[i].TEN_PHUONG_XA+"</option>");
          }
        });
        document.getElementById('list3').style.visibility = 'visible';
      }else {
        document.getElementById('list3').style.visibility = 'hidden';
      }
      return false;
    }
    </script>
